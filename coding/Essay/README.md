### 设计模式

#### 23种设计模式

+ 创建型设计模式
  + 单例模式、工厂模式
+ 结构型设计模式
  + 适配器模式、代理模式
+ 行为型设计模式
  + 迭代器模式、观察者模式

#### 单例模式

+ 该类只能创建一个对象

  > 我们想让一个类只能创建一个对象，就必须将构造函数私有化，否则就能创建无数个对象；
  >
  > 这样就无法在类外创建实例了，只能在类内部实现一个getInstance方法，该方法在堆空间上new一个对象，但同样的，它能new无数个对象；
  >
  > 解决方法是使用静态成员函数（为什么用静态？因为无法在类外实例化对象，只能通过类名调用该方法），当然也需要一个指针保存第一次new的对象的地址，这些再次new对象时，就返回第一次new的对象地址，（那该方法返回值也是指针类型）而静态成员函数内部只能用静态数据成员，所以指针也要设置成static。

+ 实现步骤：

  + 构造函数私有化
  + 定义一个返回值为类指针的静态成员函数
  + 创建一个static指针保存第一次创建的对象

+ 应用场景：只需要全局唯一的对象，都可以用单例对象

  + 单例模式替换全局变量 （全局变量多了，模块直接耦合性增大）
  + 配置文件中存储的都是程序的输入信息，都可以用单例对象保存
  + 词典库、网页库

#### 工厂模式

> 简单工厂、工厂方法、抽象工厂
>
> 以创建图形为例

1. 简单工厂，又叫静态工厂方法，非23种设计模式

   缺点：

   + 不满足单一职责原则：一个类最多只做一件事，一个引起它变化的原因
   + 不满足开放闭合原则：有新的图形加进来时，需要修改Factory类

2. 工厂方法

   > 定义一个用于创建对象的接口，让子类决定实例化哪一个类

   新来一个图形，创建一个类派生自Figure，创建一个工厂类派生自Factory

   优点：符合单一职责原则，满足开放闭合原则

   适用场景：针对复杂对象，批量创建对象。

   ![FactoryMethod.jpg](https://gitee.com/snow-tyan/learn-cpp/raw/master/Figure/FactoryMethod.jpg)


3. 抽象工厂

   一个工厂可以生产多种系列产品，FigureA, FigureB...

   ![](https://gitee.com/snow-tyan/learn-cpp/raw/master/Figure/AbstractFactory.jpg)

#### 观察者模式

>  对象间的一种一对多依赖关系，当一个对象的状态发生改变时，所有**依赖于**它的对象都得到通知并自动更新，又称发布-订阅模式。
>
>  婴儿和护士是观察者，门铃是主题，客人按下门铃，门铃状态发生改变，观察者婴儿和护士跟着做处理操作。这里的操作是婴儿哭(30%)或继续睡(70%)，护士起床开门(70%)或继续睡(30%)。

![](https://gitee.com/snow-tyan/learn-cpp/raw/master/Figure/Observer.jpg)
